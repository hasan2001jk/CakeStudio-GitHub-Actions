---
- name: Ensure hosts are reachable
  hosts: all
  gather_facts: no
  tasks:
    - name: Wait for SSH connection
      wait_for_connection:
        timeout: 300  # Adjust timeout value as needed
        
- name: Setup Kubernetes Cluster
  hosts: master,worker
  become: yes
  roles:
    - common
    - containerd
    - kubernetes

- name: Setup Kubernetes Cluster (MASTER)
  hosts: master
  become: yes
  roles:
    - master


- name: Setup Kubernetes Cluster (WORKER)
  hosts: worker
  become: yes
  roles:
    - worker

- name: Setup SonarQube Server
  hosts: sonarqube
  become: yes
  roles:
    - sonarqube

